<!DOCTYPE html>
<html>
	<head>
		<meta
			name="viewport"
			content="user-scalable=no, width=device-width, initial-scale=1, maximum-scale=1"
		/>
		<!-- for high pixel devices -->
		<link
			rel="stylesheet"
			type="text/css"
			href="css/stx-chart.css"
			media="screen"
		/>
		<!-- Required - default style sheet -->
		<link
			rel="stylesheet"
			type="text/css"
			href="css/chartiq.css"
			media="screen"
		/>
		<link
			rel="stylesheet"
			type="text/css"
			href="css/normalize.css"
			media="screen"
		/>
		<link
			rel="stylesheet"
			type="text/css"
			href="css/page-defaults.css"
			media="screen"
		/>
	</head>
	<style>
		cq-scroll {
			overflow: hidden !important;
		}

		/* TODO: This is a short term fix to hide the chart that renders in the background.
		Long-term the chart should not be drawn at all.
		 */
		.chartContainer > div.stx_chart_controls.chartControls {
			display: none !important;
		}
		
		canvas {
			display: none !important;
		}
		
	</style>

	<body>
		<cq-context class="ciq-night">
			<cq-ui-manager></cq-ui-manager>
			<div
				class="chartContainer"
				style="width: 100%; height: 100%; position: relative;"
			>
				<cq-orderbook cq-active>
					<cq-orderbook-table reverse>
						<cq-scroll cq-no-resize>
							<cq-orderbook-bids></cq-orderbook-bids>
						</cq-scroll>
					</cq-orderbook-table>
					<cq-orderbook-table>
						<cq-scroll cq-no-resize>
							<cq-orderbook-asks></cq-orderbook-asks>
						</cq-scroll>
					</cq-orderbook-table>
					<template>
						<cq-item cq-size-shading>
							<div col="price">Price</div>
							<div col="size">Size</div>
							<div col="cum_size">Total Size</div>
							<div col="amount">Amount</div>
							<div col="cum_amount">Total Amount</div>
							<div col="shading"></div>
						</cq-item>
					</template>
				</cq-orderbook>
			</div>
		</cq-context>

		<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>

		<script type="module" crossorigin="use-credentials">
			import "./js/advanced.js";
			import "./js/addOns.js";
			import { CIQ } from "./js/components.js";
			import "./plugins/activetrader/cryptoiq.js";
			import "./examples/feeds/L2_simulator.js";
			import getDefaultConfig from "./js/defaultConfiguration.js";
			import PerfectScrollbar from "./js/thirdparty/perfect-scrollbar.esm.js";
			import quotefeed from "./examples/feeds/quoteFeedSimulator.js";
			import "./examples/feeds/quoteFeedXignite.js";
			import "./examples/feeds/symbolLookupChartIQ.js";
			import "./examples/markets/marketDefinitionsSample.js";
			import "./examples/markets/marketSymbologySample.js";
			import "./examples/translations/translationSample.js";

			const stxx = new CIQ.ChartEngine({
				container: document.querySelector(".chartContainer"),
			});

			stxx.xAxisAsFooter = true;

			// variable scoping for integration
			window.context = {
				stxx,
				CIQ,
				quoteFeedSimulator: quotefeed,
			};

			window.stxx = stxx; // for integration

			const urlParams = new URLSearchParams(window.location.search);
			let symbol = urlParams.get('symbol');
			symbol = symbol ? symbol : "EURUSD";

			stxx.chart.symbol = symbol;
			new CIQ.UI.Context(stxx, document.querySelector("cq-context"));
			stxx.attachQuoteFeed(quotefeed, { refreshInterval: 1 });
			CIQ.simulateL2({ stx: stxx, onTrade: true });
			CIQ.UI.begin();

		</script>
	</body>
</html>
